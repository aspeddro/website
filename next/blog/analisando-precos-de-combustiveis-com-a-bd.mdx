---
title: Analisando pre√ßos de combust√≠veis com a BD+
description: >-
  Veja como analisar a varia√ß√£o m√©dia dos pre√ßos de combust√≠veis no Brasil com
  valores corrigidos pelo IPCA
date: '2021-10-29T15:22:29.489Z'
categories: []
keywords: []
slug: >-
  /@basedosdados/analisando-pre%C3%A7os-de-combust%C3%ADveis-com-a-bd-9524fadbdfb4
---
![](https://storage.googleapis.com/basedosdados-website/blog/analisando-precos-de-combustiveis-com-a-bd/image_0.jpg)

**Texto por** [**Lucas Moreira**](https://github.com/lucasnascm) **e** [**Gustavo Aires**](https://github.com/gustavoairestiago)**,** da Base dos Dados **üíö**

> Data da publica√ß√£o original: 29/10/2021

#### TL;DR

Qual o pre√ßo do combust√≠vel na sua cidade? Neste artigo vamos apresentar os dados da base de pesquisa com pre√ßos de distribui√ß√£o de combust√≠veis e de g√°s de cozinha (GLP), divulgados pela [Ag√™ncia Nacional do Petr√≥leo](https://www.gov.br/anp/pt-br). Al√©m disso, vamos apresentar uma an√°lise da evolu√ß√£o dos pre√ßos em rela√ß√£o √† infla√ß√£o, demonstrando como voc√™ pode usar a Base dos Dados para analisar como √© esse cen√°rio em sua pr√≥pria cidade, ou no recorte que quiser. Dentre os t√≥picos deste texto, voc√™ encontra:

* **Entendendo a S√©rie Hist√≥rica de Pre√ßos**
* **Como consultar esses dados**
* **Os olhos da cara: Analisando a evolu√ß√£o de pre√ßo dos combust√≠veis no Brasil**
* **Como criar um gr√°fico para ilustrar a an√°lise**

![](https://storage.googleapis.com/basedosdados-website/blog/analisando-precos-de-combustiveis-com-a-bd/image_1.gif)

**Entendendo a S√©rie Hist√≥rica de Pre√ßos**

A ANP fornece, a cada semana, a s√©rie hist√≥rica com os microdados dos pre√ßos praticados por diferentes postos de revenda em todo o Brasil. A base inclui informa√ß√µes dos pre√ßos da gasolina, etanol, diesel s10, gasolina aditivada, glp, diesel e gnv, desde 2004 at√© outubro de 2021.

A Base dos Dados disponibiliza estes dados de uma maneira mais intuitiva: tratados, padronizados e compatibilizados. Especificamente, o [script de tratamento](https://github.com/basedosdados/mais/blob/master/bases/br_anp_precos_combustiveis/code/%5Bdados%5D_br_anp_preco_combustiveis.ipynb) dos dados consistiu em unir os *dataframes* com os diferentes tipos de combust√≠veis e meses do ano, al√©m de incluir o c√≥digo do IBGE para os munic√≠pios presentes na base‚Ää‚Äî‚Ääo que facilita o *merge* com outras informa√ß√µes. A inclus√£o do c√≥digo do IBGE tamb√©m simplifica a visualiza√ß√£o da tabela, mudando o formato da data ou ainda compatibilizando o endere√ßo do estabelecimento. Vale ressaltar que a pesquisa abrange 883 munic√≠pios, ao longo dos 18 anos de pesquisa. S√≥ em 2021 foram coletadas informa√ß√µes de 22.629 postos de revenda dos 27 estados.

A base cont√©m informa√ß√µes sobre a localiza√ß√£o de cada posto (UF, munic√≠pio e endere√ßo completo), especificidades do estabelecimento (CNPJ, nome e bandeira), al√©m do produto e dos pre√ßos praticados nas mais de 26 milh√µes de observa√ß√µes.

**Como consultar esses dados**

A BD+ permite que voc√™ acesse todas essas informa√ß√µes com uma simples consulta de SQL no BigQuery, ou atrav√©s dos nossos pacotes no Python e no R. Por conta do tamanho da base, o download direto pela plataforma n√£o √© poss√≠vel.

Para explorar os dados dessa base, acesse a [p√°gina deste conjunto de dados](https://basedosdados.org/dataset/c962b5e4-e71c-4e7c-b172-5e70951be633) em nossa plataforma e confira a se√ß√£o Consulta aos Dados.

![P√°gina do conjunto Pre√ßos de Combust√≠veis‚Ää‚Äî‚ÄäDados Hist√≥ricos](https://storage.googleapis.com/basedosdados-website/blog/analisando-precos-de-combustiveis-com-a-bd/image_2.png)![Se√ß√£o consulte esses dados](https://storage.googleapis.com/basedosdados-website/blog/analisando-precos-de-combustiveis-com-a-bd/image_3.png)

**Os olhos da cara‚Ää‚Äî‚ÄäAnalisando a evolu√ß√£o de pre√ßo dos combust√≠veis no Brasil**

As not√≠cias nos √∫ltimos meses t√™m anunciado a constante alta dos combust√≠veis. Muito se fala da gasolina √† R$7, dos impostos, insumos e da cota√ß√£o do d√≥lar. Nossa an√°lise prop√µe observar os dados deflacionados e comparados √† infla√ß√£o, isto √©, a varia√ß√£o dos pre√ßos atuais em rela√ß√£o √† varia√ß√£o do √≠ndice de pre√ßos ao consumidor.

![](https://storage.googleapis.com/basedosdados-website/blog/analisando-precos-de-combustiveis-com-a-bd/image_4.gif)

Cumprindo a nossa miss√£o‚Ää‚Äî‚Ääacessar os dados em um √∫nico lugar‚Ää‚Äî‚Ääconseguimos captar dados do [√çndice Nacional de Pre√ßos ao Consumidor Amplo (IPCA)](https://basedosdados.org/dataset/c58781fb-1177-448d-87ff-56b5cbf1735c), tamb√©m dispon√≠veis na BD+, al√©m de manipular a nossa base de pre√ßos dos combust√≠veis da Ag√™ncia Nacional do Petr√≥leo, G√°s Natural e Biocombust√≠veis (ANP).

Com o c√≥digo SQL(query) abaixo, conseguiremos extrair: o ano e m√™s de refer√™ncia das informa√ß√µes; o produto (combust√≠vel) e seu pre√ßo m√©dio da base da ANP, al√©m de atualizar o pre√ßo para os valores atuais com os dados da infla√ß√£o.

* Etapa #1

Na etapa #1, indicada na query acima, fazemos uma subconsulta para retornar o combust√≠vel desejado da base de pre√ßos da ANP e o √≠ndice de infla√ß√£o atual do IPCA. Para isso, extra√≠mos o m√™s da data de coleta dos pre√ßos e fazemos uma jun√ß√£o(join) com o m√™s atual da tabela `mes_brasil`, do dataset `br_ibge_ipca`. Fazemos isso filtrando o m√™s e ano que desejamos utilizar como base para a atualiza√ß√£o dos pre√ßos. Neste caso, utilizamos ano=2021 e mes=9, mas voc√™ pode atualizar essas informa√ß√µes de acordo com os dados dispon√≠veis nas bases.

* Etapa #2

Na etapa #2, deflacionamos os pre√ßos dos combust√≠veis, o que, em resumo, significa corrigi-los para o valor da data de refer√™ncia de sua escolha. O c√°lculo √© simples: dividimos o √≠ndice da infla√ß√£o do per√≠odo que desejamos utilizar como base pelo √≠ndice da infla√ß√£o do per√≠odo ao qual o pre√ßo se refere. Para isso, fazemos a jun√ß√£o dos produtos resultantes da subconsulta com os produtos da tabela de pre√ßos. Assim, conseguimos dividir o √≠ndice base de infla√ß√£o do m√™s escolhido com o √≠ndice referente aos pre√ßos em cada per√≠odo e multiplic√°-lo por cada um dos pre√ßos da s√©rie hist√≥rica.

Por fim, com a consulta executada, iremos obter uma tabela com os pre√ßos de combust√≠veis desde 2004, atualizados para pre√ßos de setembro de 2021. Agora esses valores podem ser comparados entre si, com a equival√™ncia dos pre√ßos em valores atuais corrigidos pelo IPCA.

**Como criar um gr√°fico para ilustrar a an√°lise**

![](https://storage.googleapis.com/basedosdados-website/blog/analisando-precos-de-combustiveis-com-a-bd/image_5.png)

Iremos demonstrar a constru√ß√£o de um gr√°fico para comparar a evolu√ß√£o dos pre√ßos com a taxa de infla√ß√£o realizando uma normaliza√ß√£o dos valores para 2004. Para isso, utilizamos o [Plotly](https://plotly.com/python/), uma poderosa ferramenta gr√°fica dispon√≠vel para diferentes linguagens.

N√£o estamos analisando aqui o pre√ßo m√©dio do combust√≠vel, mas a varia√ß√£o dos pre√ßos ao longo dos meses, utilizando como base o ano de in√≠cio dos dados em compara√ß√£o com o crescimento inflacion√°rio dos pre√ßos.

O primeiro passo √© instalar e importar os pacotes python. Utilizamos o pacote basedosdados para realizar a consulta na base de dados, a biblioteca pandas para o tratamento e manipula√ß√£o dos dados e plotly para a elabora√ß√£o da visualiza√ß√£o gr√°fica. Abaixo demonstramos como instalar e importar os pacotes:

Com a query abaixo conseguimos extrair: o ano e m√™s de refer√™ncia das informa√ß√µes; o produto (combust√≠vel) e seu pre√ßo m√©dio da base da ANP no m√™s e em maio de 2004 (data base), al√©m de normalizar o pre√ßo e o √≠ndice de infla√ß√£o para os valores da data base.

Nesta primeira query fazemos uma subconsulta para retornar o combust√≠vel da base de pre√ßos da ANP, o √≠ndice de infla√ß√£o IPCA e o pre√ßo em maio de 2004.

![](https://storage.googleapis.com/basedosdados-website/blog/analisando-precos-de-combustiveis-com-a-bd/image_6.png)

Na segunda consulta, iremos normalizar os pre√ßos dos combust√≠veis e o √≠ndice de infla√ß√£o. No c√°lculo da normaliza√ß√£o, dividimos o pre√ßo do per√≠odo ao qual se refere o dado pelo pre√ßo em maio de 2004. Faremos o mesmo com o √≠ndice de infla√ß√£o. Para isso, √© preciso fazer a jun√ß√£o dos produtos resultantes da subconsulta com os produtos da tabela de pre√ßos, para realizarmos a normaliza√ß√£o com os valores necess√°rios da data base e dos pre√ßos de cada combust√≠vel em cada m√™s.

Nesse pr√≥ximo passo, execute a requisi√ß√£o pelo pacote da basedosdados indicando ‚Äòdf‚Äô como o objeto que armazenar√° o DataFrame:

Com as transforma√ß√µes acima, modificamos as datas nos formatos desej√°veis (`ano_mes`) para a constru√ß√£o do gr√°fico e ordenamos os valores de forma ascendente pelas datas.

Criaremos uma lista com os combust√≠veis para um la√ßo de cria√ß√£o de listas com datas e pre√ßos normalizados de cada combust√≠vel e uma lista com os valores normalizados da infla√ß√£o. Para isso, faremos transforma√ß√µes nas colunas, retirando espa√ßos entre os nomes dos produtos e criando uma lista com valores √∫nicos de produto(combust√≠vel).

O la√ßo abaixo cria as listas de pre√ßos normalizados e datas para cada combust√≠vel.

O plotly cria os gr√°ficos a partir do desenho dos tra√ßos (`fig_trace`) de cada produto. Portanto, precisamos configurar cada tra√ßo com os par√¢metros de cor e largura da linha (voc√™ pode alterar esses par√¢metros quando quiser). O segundo passo √© configurar os valores dos eixos x e y com seus respectivos r√≥tulos. Os valores de ‚Äútickvals‚Äù devem ser os mesmos da base de dados, o ‚Äúticktext‚Äù pode ser alterado por voc√™ com o formato de valores de sua prefer√™ncia, esse √© somente o r√≥tulo de dados para os valores de ‚Äútickvals‚Äù. Confira abaixo:

Por fim √© s√≥ executar `fig.write_image` (‚Äògrafico.png‚Äô) para salvar o gr√°fico no caminho especificado, como demonstramos acima.

Essa e outras an√°lises voc√™ consegue acompanhar na √≠ntegra pelo nosso [Github](https://github.com/basedosdados/analises). A Base dos Dados √© uma iniciativa open source e sem fins lucrativos que busca diminuir a dist√¢ncia entre sua pergunta e os dados. Esperamos que voc√™ se sinta inspirado em utilizar esse e outros dados. Afinal, muitas outras an√°lises podem ser realizadas. Compartilhe conosco seus achados em nossas redes sociais ou em nossa comunidade no [Discord](https://discord.gg/WzzzQs9T).
